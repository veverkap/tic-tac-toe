<html>
  <head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">  
    <style type="text/css">
      th {
        height: 100px;
        font-size: 28px;
        text-align: center;
      }
      .player {
        height: 271px;
        width: 300px;
      }
      .player-x {
        
        background: url("https://cdn.rawgit.com/veverkap/tic-tac-toe/master/tic-clipart-tic-tac-toe-hi.png") -298px 0;
      }
      .player-o {
        background: url("https://cdn.rawgit.com/veverkap/tic-tac-toe/master/tic-clipart-tic-tac-toe-hi.png") 0px 2px;
      }      
    </style>
  </head>
  <body>
  <table align="center" border="1">
    <thead>
      <tr>
        <th id="current_player" data-player="x" colspan="3" class="bg-warning">
          <div id="current_player_name">Current Player: X</div>
        </th>
      </tr>
    </thead>
    <tr>
      <td>
        <img id="0x0" data-x="0" data-y="0" data-player="z" src="https://cdn.rawgit.com/veverkap/tic-tac-toe/master/pixel.gif" class="player" />
      </td>
      <td>
        <img id="1x0" data-x="1" data-y="0" data-player="z" src="https://cdn.rawgit.com/veverkap/tic-tac-toe/master/pixel.gif" class="player" />
      </td>
      <td>
        <img id="2x0" data-x="2" data-y="0" data-player="z" src="https://cdn.rawgit.com/veverkap/tic-tac-toe/master/pixel.gif" class="player" />
      </td>      
    </tr>
    <tr>
      <td>
        <img id="0x1" data-x="0" data-y="1" data-player="z" src="https://cdn.rawgit.com/veverkap/tic-tac-toe/master/pixel.gif" class="player" />
      </td>
      <td>
        <img id="1x1" data-x="1" data-y="1" data-player="z" src="https://cdn.rawgit.com/veverkap/tic-tac-toe/master/pixel.gif" class="player" />
      </td>
      <td>
        <img id="2x1" data-x="2" data-y="1" data-player="z" src="https://cdn.rawgit.com/veverkap/tic-tac-toe/master/pixel.gif" class="player" />
      </td>      
    </tr>
    <tr>
      <td>
        <img id="0x2" data-x="0" data-y="2" data-player="z" src="https://cdn.rawgit.com/veverkap/tic-tac-toe/master/pixel.gif" class="player" />
      </td>
      <td>
        <img id="1x2" data-x="1" data-y="2" data-player="z" src="https://cdn.rawgit.com/veverkap/tic-tac-toe/master/pixel.gif" class="player" />
      </td>
      <td>
        <img id="2x2" data-x="2" data-y="2" data-player="z" src="https://cdn.rawgit.com/veverkap/tic-tac-toe/master/pixel.gif" class="player" />
      </td>      
    </tr>    
    <tfoot>
      <tr>
        <th colspan="3" id="error_msg">
        </th>
      </tr>
    </tfoot>    
  </table>
  <br />
  <div align="center"> <button id="reset_btn" type="button" class="btn btn-primary btn-lg">RESET</button></div>
  <a href="https://github.com/veverkap/tic-tac-toe">
    <img style="position: absolute; top: 0; left: 0; border: 0;" src="https://camo.githubusercontent.com/82b228a3648bf44fc1163ef44c62fcc60081495e/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_left_red_aa0000.png">
  </a>
  </body>
  <script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
  <script type="text/javascript">

  TicTacToe = (function() {
    function TicTacToe() {
      this.game_over = false;
      this.winner    = 0;
    }

    TicTacToe.prototype.is_match = function(first_coords, second_coords, third_coords) {
      var first  = $("img[data-x=" +  first_coords[0] + "][data-y=" +  first_coords[1] + "]");
      var second = $("img[data-x=" + second_coords[0] + "][data-y=" + second_coords[1] + "]");
      var third  = $("img[data-x=" +  third_coords[0] + "][data-y=" +  third_coords[1] + "]");
      if ((first.data("player") != "z") && (first.data("player") == second.data("player")) && (second.data("player") == third.data("player"))) {
        window.game.winner = first.data("player");
        first.parent().addClass("bg-success");
        second.parent().addClass("bg-success");
        third.parent().addClass("bg-success");
        return true;
      }
      return false;      
    }

    TicTacToe.prototype.current_player = function() {
      return $("#current_player").data("player");
    }

    TicTacToe.prototype.toggle_player = function() {
      if (window.game.current_player() == "x") {
        $("#current_player").data("player", "o");
        $("#current_player_name").html("Current Player: O");
      } else {
        $("#current_player").data("player", "x");
        $("#current_player_name").html("Current Player: X");
      }
    }

    TicTacToe.prototype.is_game_over = function() {
      // check the rows
      for (var y = 0; y < 3; y++) {
        if (window.game.is_match([0,y], [1,y], [2,y])) {
          return true;
        }
      }

      // check the columns
      for (var x = 0; x < 3; x++) {
        if (window.game.is_match([x,0], [x,1], [x,2])) {
          return true;
        }
      }

      // check left top to bottom right diagonal
      if (window.game.is_match([0,0], [1,1], [2,2])) {
        return true;
      }

      // check left top to bottom right diagonal
      if (window.game.is_match([2,0], [1,1], [0,2])) {
        return true;
      }

      // check that there are spots without owners
      var count = $("img.player").filter(function(item) {
        return $(this).data("player") == "z";
      }).length;
      
      if (count == 0) {
        window.game.winner = "z";
        return true;
      }
      return false;
    }

    TicTacToe.prototype.can_move = function(coordinate_owner, player) {
      if (coordinate_owner === "z") {
        $("#error_msg").html("").removeClass("bg-danger");
        return true;
      }
      if (player != coordinate_owner) {
        $("#error_msg").html("The other player owns this, you can't have it!").addClass("bg-danger");
        return false;
      }      
      if (player == coordinate_owner) {
        $("#error_msg").html("You already chose this one!").addClass("bg-danger");
        return false;
      }
    }

    TicTacToe.prototype.move = function(e) {
      if (window.game.game_over) {
        return false;
      }
      var x_coordinate      = $(e.target).data("x");
      var y_coordinate      = $(e.target).data("y");
      var coordinate_owner  = $(e.target).data("player");
      var player            = window.game.current_player();

      if (window.game.can_move(coordinate_owner, player)) {
        $(e.target).data("player", player).addClass("player-" + player);
        $(e.target).parent().addClass("parent-player-" + player);
        window.game.toggle_player();
      }

      if (window.game.is_game_over()) {
        window.game.game_over = true;
        var msg = "";
        if (window.game.winner == "z") {
          msg = "GAME OVER, NO ONE WINS";
          $("#error_msg").addClass("bg-danger");
        } else {
          msg = "GAME OVER, PLAYER " + window.game.winner.toUpperCase() + " WINS";
          $("#error_msg").addClass("bg-success");
        }
        $("#current_player_name").html("GAME OVER");
        $("#error_msg").html(msg);
      }
      e.preventDefault();
      return true;
    };

    return TicTacToe;

  })();

  $(function() {
    window.game = new TicTacToe();
    $("img.player").on("click", window.game.move);
    $("#reset_btn").on("click", function() { window.location.reload(); });
  });
  </script>
</html>