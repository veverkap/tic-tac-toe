<html>
  <head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">  
    <style type="text/css">
      th {
        height: 100px;
        font-size: 28px;
        text-align: center;
      }
      .player {
        height: 271px;
        width: 300px;
      }
      img[data-owner='x'] {
        background: url("https://cdn.rawgit.com/veverkap/tic-tac-toe/master/tic-clipart-tic-tac-toe-hi.png") -298px 0;
      }
      .player-x {
        background: url("https://cdn.rawgit.com/veverkap/tic-tac-toe/master/tic-clipart-tic-tac-toe-hi.png") -298px 0;
      }

      .player-o {
        background: url("https://cdn.rawgit.com/veverkap/tic-tac-toe/master/tic-clipart-tic-tac-toe-hi.png") 0px 2px;
      }      
    </style>
  </head>
  <body>
  <table align="center" border="1">
    <tr>
      <th id="current_player" data-player="x" colspan="3">
        <div id="current_player_name" class="bg-info">Current Player: X</div>
        <div id="error_msg" class="bg-danger"></div>
      </th>
    </tr>
    <tr>
      <td>
        <img id="0x0" data-x="0" data-y="0" data-player="z" src="https://cdn.rawgit.com/veverkap/tic-tac-toe/master/pixel.gif" class="player" />
      </td>
      <td>
        <img id="1x0" data-x="1" data-y="0" data-player="z" src="https://cdn.rawgit.com/veverkap/tic-tac-toe/master/pixel.gif" class="player" />
      </td>
      <td>
        <img id="2x0" data-x="2" data-y="0" data-player="z" src="https://cdn.rawgit.com/veverkap/tic-tac-toe/master/pixel.gif" class="player" />
      </td>      
    </tr>
    <tr>
      <td>
        <img id="0x1" data-x="0" data-y="1" data-player="z" src="https://cdn.rawgit.com/veverkap/tic-tac-toe/master/pixel.gif" class="player" />
      </td>
      <td>
        <img id="1x1" data-x="1" data-y="1" data-player="z" src="https://cdn.rawgit.com/veverkap/tic-tac-toe/master/pixel.gif" class="player" />
      </td>
      <td>
        <img id="2x1" data-x="2" data-y="1" data-player="z" src="https://cdn.rawgit.com/veverkap/tic-tac-toe/master/pixel.gif" class="player" />
      </td>      
    </tr>
    <tr>
      <td>
        <img id="0x2" data-x="0" data-y="2" data-player="z" src="https://cdn.rawgit.com/veverkap/tic-tac-toe/master/pixel.gif" class="player" />
      </td>
      <td>
        <img id="1x2" data-x="1" data-y="2" data-player="z" src="https://cdn.rawgit.com/veverkap/tic-tac-toe/master/pixel.gif" class="player" />
      </td>
      <td>
        <img id="2x2" data-x="2" data-y="2" data-player="z" src="https://cdn.rawgit.com/veverkap/tic-tac-toe/master/pixel.gif" class="player" />
      </td>      
    </tr>    
  </table>
  <br />
  <div align="center"> <button id="reset_btn" type="button" class="btn btn-primary btn-lg">RESET</button></div>
  </body>
  <script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
  <script type="text/javascript">

  TicTacToe = (function() {
    function TicTacToe() {
      this.game_over = false;
      this.winner    = 0;
    }

    TicTacToe.prototype.is_match = function(first_coords, second_coords, third_coords) {
      var first  = $("img[data-x=" +  first_coords[0] + "][data-y=" +  first_coords[1] + "]").data("player");
      var second = $("img[data-x=" + second_coords[0] + "][data-y=" + second_coords[1] + "]").data("player");
      var third  = $("img[data-x=" +  third_coords[0] + "][data-y=" +  third_coords[1] + "]").data("player");
      if ((first != "z") && (first == second) && (second == third)) {
        window.game.winner = first;
        return true;
      }
      return false;      
    }

    TicTacToe.prototype.current_player = function() {
      return $("#current_player").data("player");
    }

    TicTacToe.prototype.toggle_player = function() {
      if (window.game.current_player() == "x") {
        $("#current_player").data("player", "o");
        $("#current_player_name").html("Current Player: O");
      } else {
        $("#current_player").data("player", "x");
        $("#current_player_name").html("Current Player: X");
      }
    }

    TicTacToe.prototype.is_game_over = function() {
      // check the rows
      for (var y = 0; y < 3; y++) {
        if (window.game.is_match([0,y], [1,y], [2,y])) {
          return true;
        }
      }

      // check the columns
      for (var x = 0; x < 3; x++) {
        if (window.game.is_match([x,0], [x,1], [x,2])) {
          return true;
        }
      }

      // check left top to bottom right diagonal
      if (window.game.is_match([0,0], [1,1], [2,2])) {
        return true;
      }

      // check left top to bottom right diagonal
      if (window.game.is_match([2,0], [1,1], [0,2])) {
        return true;
      }

      // check that there are spots without owners
      var count = $("img.player").filter(function(item) {
        return $(this).data("player") == "z";
      }).length;
      
      if (count == 0) {
        window.game.winner = "z";
        return true;
      }
      return false;
    }

    TicTacToe.prototype.can_move = function(coordinate_owner, player) {
      if (coordinate_owner === "z") {
        $("#error_msg").html("");
        return true;
      }
      if (player != coordinate_owner) {
        $("#error_msg").html("The other player owns this, you can't have it!");
        return false;
      }      
      if (player == coordinate_owner) {
        $("#error_msg").html("You already chose this one!");
        return false;
      }
    }

    TicTacToe.prototype.move = function(e) {
      if (window.game.game_over) {
        return false;
      }
      var x_coordinate      = $(e.target).data("x");
      var y_coordinate      = $(e.target).data("y");
      var coordinate_owner  = $(e.target).data("player");
      var player            = window.game.current_player();

      if (window.game.can_move(coordinate_owner, player)) {
        $(e.target).data("player", player).addClass("player-" + player);
        window.game.toggle_player();
      }

      if (window.game.is_game_over()) {
        window.game.game_over = true;
        var msg = "GAME OVER, NO ONE WINS";
        if (window.game.winner != "z") {
          var msg = "GAME OVER, PLAYER " + window.game.winner.toUpperCase() + " WINS";
        }
        $("#error_msg").html(msg);
        setTimeout(function(){ alert(msg); }, 100);
      }
      e.preventDefault();
      return true;
    };

    return TicTacToe;

  })();

  $(function() {
    window.game = new TicTacToe();
    $("img").on("click", window.game.move);
    $("#reset_btn").on("click", function() { window.location.reload(); });
  });
  </script>
</html>